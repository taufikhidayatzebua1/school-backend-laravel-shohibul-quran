<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Test Guru API</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }
            .container {
                max-width: 1200px;
                margin: 0 auto;
                background: white;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                padding: 30px;
            }
            h1 {
                color: #333;
                margin-bottom: 10px;
                text-align: center;
            }
            .subtitle {
                text-align: center;
                color: #666;
                margin-bottom: 30px;
            }
            .auth-section {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 30px;
            }
            .auth-section h2 {
                color: #495057;
                margin-bottom: 15px;
                font-size: 1.2rem;
            }
            .form-group {
                margin-bottom: 15px;
            }
            label {
                display: block;
                margin-bottom: 5px;
                color: #495057;
                font-weight: 500;
            }
            input,
            textarea,
            select {
                width: 100%;
                padding: 10px;
                border: 1px solid #ced4da;
                border-radius: 5px;
                font-size: 14px;
            }
            textarea {
                resize: vertical;
                min-height: 60px;
            }
            .input-group {
                display: flex;
                gap: 10px;
            }
            .input-group input,
            .input-group select {
                flex: 1;
            }
            button {
                background: #667eea;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                transition: background 0.3s;
            }
            button:hover {
                background: #5568d3;
            }
            button:disabled {
                background: #ccc;
                cursor: not-allowed;
            }
            .btn-danger {
                background: #dc3545;
            }
            .btn-danger:hover {
                background: #c82333;
            }
            .btn-success {
                background: #28a745;
            }
            .btn-success:hover {
                background: #218838;
            }
            .btn-warning {
                background: #ffc107;
                color: #333;
            }
            .btn-warning:hover {
                background: #e0a800;
            }
            .token-display {
                background: #e9ecef;
                padding: 10px;
                border-radius: 5px;
                font-family: monospace;
                font-size: 12px;
                word-break: break-all;
                margin-top: 10px;
            }
            .endpoints {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }
            .endpoint-card {
                border: 1px solid #dee2e6;
                border-radius: 8px;
                padding: 20px;
                background: #f8f9fa;
            }
            .endpoint-card h3 {
                color: #495057;
                margin-bottom: 15px;
                font-size: 1.1rem;
            }
            .method-badge {
                display: inline-block;
                padding: 3px 8px;
                border-radius: 3px;
                font-size: 11px;
                font-weight: 600;
                margin-right: 8px;
            }
            .method-get {
                background: #28a745;
                color: white;
            }
            .method-post {
                background: #007bff;
                color: white;
            }
            .method-put {
                background: #ffc107;
                color: #333;
            }
            .method-delete {
                background: #dc3545;
                color: white;
            }
            .response-section {
                margin-top: 30px;
            }
            .response-section h2 {
                color: #495057;
                margin-bottom: 15px;
            }
            pre {
                background: #282c34;
                color: #abb2bf;
                padding: 15px;
                border-radius: 5px;
                overflow-x: auto;
                font-size: 13px;
                line-height: 1.5;
            }
            .status-badge {
                display: inline-block;
                padding: 5px 10px;
                border-radius: 5px;
                font-weight: 500;
                margin-bottom: 10px;
            }
            .status-success {
                background: #d4edda;
                color: #155724;
            }
            .status-error {
                background: #f8d7da;
                color: #721c24;
            }
            .loading {
                display: none;
                text-align: center;
                padding: 20px;
            }
            .loading.active {
                display: block;
            }
            .spinner {
                border: 3px solid #f3f3f3;
                border-top: 3px solid #667eea;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin: 0 auto;
            }
            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üë®‚Äçüè´ Test Guru API</h1>
            <p class="subtitle">
                Testing CRUD Operations untuk Data Guru (Guru, Wali Kelas,
                Kepala Sekolah)
            </p>

            <!-- Authentication Section -->
            <div class="auth-section">
                <h2>üîê Authentication</h2>
                <div class="form-group">
                    <label>API Base URL:</label>
                    <input
                        type="text"
                        id="baseUrl"
                        value="http://localhost/api/v1"
                    />
                </div>
                <div class="input-group">
                    <div class="form-group" style="flex: 1">
                        <label>Username:</label>
                        <input type="text" id="username" value="superadmin" />
                    </div>
                    <div class="form-group" style="flex: 1">
                        <label>Password:</label>
                        <input
                            type="password"
                            id="password"
                            value="password123"
                        />
                    </div>
                </div>
                <button onclick="login()">Login</button>
                <div
                    id="tokenDisplay"
                    class="token-display"
                    style="display: none"
                ></div>
            </div>

            <!-- Endpoints -->
            <h2 style="margin-bottom: 20px; color: #495057">
                üì° API Endpoints
            </h2>
            <div class="endpoints">
                <!-- List Guru -->
                <div class="endpoint-card">
                    <h3>
                        <span class="method-badge method-get">GET</span> List
                        Guru
                    </h3>
                    <div class="form-group">
                        <label>Search:</label>
                        <input
                            type="text"
                            id="searchQuery"
                            placeholder="Nama, NIP, atau No HP"
                        />
                    </div>
                    <div class="form-group">
                        <label>Filter Role:</label>
                        <select id="filterRole">
                            <option value="">Semua</option>
                            <option value="guru">Guru</option>
                            <option value="wali-kelas">Wali Kelas</option>
                            <option value="kepala-sekolah">
                                Kepala Sekolah
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Per Page:</label>
                        <input
                            type="number"
                            id="perPage"
                            value="10"
                            min="1"
                            max="100"
                        />
                    </div>
                    <button onclick="listGuru()">Get List</button>
                </div>

                <!-- Show Detail -->
                <div class="endpoint-card">
                    <h3>
                        <span class="method-badge method-get">GET</span> Detail
                        Guru
                    </h3>
                    <div class="form-group">
                        <label>Guru ID:</label>
                        <input
                            type="number"
                            id="showId"
                            placeholder="e.g., 1"
                        />
                    </div>
                    <button onclick="showGuru()">Get Detail</button>
                </div>

                <!-- Create -->
                <div class="endpoint-card">
                    <h3>
                        <span class="method-badge method-post">POST</span>
                        Create Guru
                    </h3>
                    <div class="form-group">
                        <label>Nama:</label>
                        <input
                            type="text"
                            id="createNama"
                            placeholder="Nama Lengkap"
                        />
                    </div>
                    <div class="form-group">
                        <label>Username:</label>
                        <input
                            type="text"
                            id="createUsername"
                            placeholder="username"
                        />
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input
                            type="email"
                            id="createEmail"
                            placeholder="email@example.com"
                        />
                    </div>
                    <div class="form-group">
                        <label>Role:</label>
                        <select id="createRole">
                            <option value="guru">Guru</option>
                            <option value="wali-kelas">Wali Kelas</option>
                            <option value="kepala-sekolah">
                                Kepala Sekolah
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>NIP:</label>
                        <input type="text" id="createNip" placeholder="NIP" />
                    </div>
                    <div class="form-group">
                        <label>Jenis Kelamin:</label>
                        <select id="createGender">
                            <option value="">Pilih...</option>
                            <option value="L">Laki-laki</option>
                            <option value="P">Perempuan</option>
                        </select>
                    </div>
                    <button class="btn-success" onclick="createGuru()">
                        Create
                    </button>
                </div>

                <!-- Update -->
                <div class="endpoint-card">
                    <h3>
                        <span class="method-badge method-put">PUT</span> Update
                        Guru
                    </h3>
                    <div class="form-group">
                        <label>Guru ID:</label>
                        <input
                            type="number"
                            id="updateId"
                            placeholder="e.g., 1"
                        />
                    </div>
                    <div class="form-group">
                        <label>No HP:</label>
                        <input
                            type="text"
                            id="updateNoHp"
                            placeholder="No HP Baru"
                        />
                    </div>
                    <div class="form-group">
                        <label>Alamat:</label>
                        <textarea
                            id="updateAlamat"
                            placeholder="Alamat Baru"
                        ></textarea>
                    </div>
                    <button class="btn-warning" onclick="updateGuru()">
                        Update
                    </button>
                </div>

                <!-- Delete -->
                <div class="endpoint-card">
                    <h3>
                        <span class="method-badge method-delete">DELETE</span>
                        Delete Guru
                    </h3>
                    <div class="form-group">
                        <label>Guru ID:</label>
                        <input
                            type="number"
                            id="deleteId"
                            placeholder="e.g., 1"
                        />
                    </div>
                    <button class="btn-danger" onclick="deleteGuru()">
                        Delete
                    </button>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p style="margin-top: 10px; color: #666">Loading...</p>
            </div>

            <!-- Response Section -->
            <div
                class="response-section"
                id="responseSection"
                style="display: none"
            >
                <h2>üì® Response</h2>
                <div id="statusBadge"></div>
                <pre id="responseOutput"></pre>
            </div>
        </div>

        <script>
            let authToken = "";

            function getBaseUrl() {
                return document.getElementById("baseUrl").value;
            }

            function showLoading() {
                document.getElementById("loading").classList.add("active");
                document.getElementById("responseSection").style.display =
                    "none";
            }

            function hideLoading() {
                document.getElementById("loading").classList.remove("active");
            }

            function showResponse(status, data) {
                hideLoading();
                const responseSection =
                    document.getElementById("responseSection");
                const statusBadge = document.getElementById("statusBadge");
                const responseOutput =
                    document.getElementById("responseOutput");

                responseSection.style.display = "block";

                if (status >= 200 && status < 300) {
                    statusBadge.innerHTML = `<span class="status-badge status-success">‚úì ${status} Success</span>`;
                } else {
                    statusBadge.innerHTML = `<span class="status-badge status-error">‚úó ${status} Error</span>`;
                }

                responseOutput.textContent = JSON.stringify(data, null, 2);
            }

            async function login() {
                const username = document.getElementById("username").value;
                const password = document.getElementById("password").value;

                showLoading();

                try {
                    const response = await fetch(`${getBaseUrl()}/auth/login`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            Accept: "application/json",
                        },
                        body: JSON.stringify({ username, password }),
                    });

                    const data = await response.json();
                    showResponse(response.status, data);

                    if (data.success && data.data.token) {
                        authToken = data.data.token;
                        document.getElementById("tokenDisplay").style.display =
                            "block";
                        document.getElementById(
                            "tokenDisplay"
                        ).textContent = `Token: ${authToken}`;
                        alert("Login berhasil! Token disimpan.");
                    }
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }

            async function listGuru() {
                if (!authToken) {
                    alert("Silakan login terlebih dahulu!");
                    return;
                }

                const search = document.getElementById("searchQuery").value;
                const role = document.getElementById("filterRole").value;
                const perPage = document.getElementById("perPage").value;

                let url = `${getBaseUrl()}/guru?per_page=${perPage}`;
                if (search) url += `&search=${encodeURIComponent(search)}`;
                if (role) url += `&role=${role}`;

                showLoading();

                try {
                    const response = await fetch(url, {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${authToken}`,
                            Accept: "application/json",
                        },
                    });

                    const data = await response.json();
                    showResponse(response.status, data);
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }

            async function showGuru() {
                if (!authToken) {
                    alert("Silakan login terlebih dahulu!");
                    return;
                }

                const id = document.getElementById("showId").value;
                if (!id) {
                    alert("Masukkan ID Guru!");
                    return;
                }

                showLoading();

                try {
                    const response = await fetch(`${getBaseUrl()}/guru/${id}`, {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${authToken}`,
                            Accept: "application/json",
                        },
                    });

                    const data = await response.json();
                    showResponse(response.status, data);
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }

            async function createGuru() {
                if (!authToken) {
                    alert("Silakan login terlebih dahulu!");
                    return;
                }

                const payload = {
                    nama: document.getElementById("createNama").value,
                    username: document.getElementById("createUsername").value,
                    email: document.getElementById("createEmail").value,
                    role: document.getElementById("createRole").value,
                    nip: document.getElementById("createNip").value,
                    jenis_kelamin:
                        document.getElementById("createGender").value,
                    password: "password123",
                };

                if (!payload.nama || !payload.username || !payload.email) {
                    alert("Nama, Username, dan Email wajib diisi!");
                    return;
                }

                showLoading();

                try {
                    const response = await fetch(`${getBaseUrl()}/guru`, {
                        method: "POST",
                        headers: {
                            Authorization: `Bearer ${authToken}`,
                            "Content-Type": "application/json",
                            Accept: "application/json",
                        },
                        body: JSON.stringify(payload),
                    });

                    const data = await response.json();
                    showResponse(response.status, data);
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }

            async function updateGuru() {
                if (!authToken) {
                    alert("Silakan login terlebih dahulu!");
                    return;
                }

                const id = document.getElementById("updateId").value;
                if (!id) {
                    alert("Masukkan ID Guru!");
                    return;
                }

                const payload = {
                    no_hp: document.getElementById("updateNoHp").value,
                    alamat: document.getElementById("updateAlamat").value,
                };

                showLoading();

                try {
                    const response = await fetch(`${getBaseUrl()}/guru/${id}`, {
                        method: "PUT",
                        headers: {
                            Authorization: `Bearer ${authToken}`,
                            "Content-Type": "application/json",
                            Accept: "application/json",
                        },
                        body: JSON.stringify(payload),
                    });

                    const data = await response.json();
                    showResponse(response.status, data);
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }

            async function deleteGuru() {
                if (!authToken) {
                    alert("Silakan login terlebih dahulu!");
                    return;
                }

                const id = document.getElementById("deleteId").value;
                if (!id) {
                    alert("Masukkan ID Guru!");
                    return;
                }

                if (!confirm(`Yakin ingin menghapus guru dengan ID ${id}?`)) {
                    return;
                }

                showLoading();

                try {
                    const response = await fetch(`${getBaseUrl()}/guru/${id}`, {
                        method: "DELETE",
                        headers: {
                            Authorization: `Bearer ${authToken}`,
                            Accept: "application/json",
                        },
                    });

                    const data = await response.json();
                    showResponse(response.status, data);
                } catch (error) {
                    hideLoading();
                    alert("Error: " + error.message);
                }
            }
        </script>
    </body>
</html>
